<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-388caa17-5fb0-4fb5-93b2-9cdfd16f91ac"></attachment><p><strong>近实时性(Near Realtime[NRT])</strong></p><p>Elasticsearch是一个近实时的搜索平台。这意味着当你导入一个文档并把它变成可搜索的时间仅会有轻微的延时。</p><p><br></p><p><strong>集群(Cluster)</strong></p><p>一个集群是由一个或多个节点(服务器)组成的，通过所有的节点一起保存你的全部数据并且提供联合索引和搜索功能的节点集合。每个集群有一个唯一的名称标识，默认是“elasticsearch”。这个名称非常重要，因为一个节点(Node)只有设置了这个名称才能加入集群，成为集群的一部分。</p><p>确保你没有在不同的环境下重用相同的名称，否则你最终可能会将节点加入错误的集群。例如你可以使用logging-dev，logging-stage和logging-prod来分别给开发，展示和生产集群命名。</p><p>注意，一个集群中只有一个节点是有效的并且是非常好的。所以这样的话，你可能需要部署多个集群并且每个集群有它们唯一的集群名称。</p><p><br></p><p><strong>节点(Node)</strong></p><p>一个节点是一个单一的服务器，是你的集群的一部分，存储数据，并且参与集群的索引和搜索功能。跟集群一样，节点在启动时也会被分配一个唯一的标识名称，这个名称默认是一个随机的UUID(Universally Unique IDentifier)。如果你不想用默认的名称，你可以自己定义节点的名称。这个名称对于管理集群节点，识别哪台服务器对应集群中的哪个节点有重要的作用。</p><p>一个节点可以通过配置特定的集群名称来加入特定的集群。默认情况下，每个节点被设定加入一个名称为“elasticsearch”的集群，这意味着如果你在你的网络中启动了一些节点，并且假设它们能相互发现，它们将会自动组织并加入一个名称是“elasticsearch”的集群。</p><p>在一个集群中，你想启动多少节点就可以启动多少节点。此外，如果没有其它节点运行在当前网络中，只启动一个节点将默认形成一个新的名称为“elasticsearch”单节点集群。</p><p><br></p><p><strong>索引(Index)</strong></p><p>一个索引就是含有某些相似特性的文档的集合。例如，你可以有一个用户数据的索引，一个产品目录的索引，还有其他的有规则数据的索引。一个索引被一个名称(必须都是小写)唯一标识，并且这个名称被用于索引通过文档去执行索引，搜索，更新和删除操作。</p><p>在一个集群中，你可以根据自己的需求定义任意多的索引。</p><p><br></p><p><strong>文档(Document)</strong></p><p>一个文档是一个可被索引的数据的基础单元。例如，你可以给一个单独的用户创建一个文档，给单个产品创建一个文档，以及其他的单独的规则。这个文档用JSON格式表现，JSON是一种普遍的网络数据交换格式。</p><p>在一个索引或类型中，你可以根据自己的需求存储任意多的文档。注意，虽然一个文档在物理存储上属于一个索引，但是文档实际上必须指定一个在索引中的类型。</p><p><br></p><p><strong>分片和复制(Shards &amp; Replicas)</strong></p><p>我们在一个索引里存储的数据，潜在的情况下可能会超过单节点硬件的存储限制。例如，单个索引有上千万个文档需要占用1TB的硬盘存储空间，但是一台机器的硬盘可能没有这么大，或者是即便有这么大，但是单个节点在提供搜索服务时会响应缓慢。</p><p>为了解决这个问题，Elasticsearch提供了分片的能力，它可以将你的索引细分成多个部分。当你创建一个索引的时候，你可以简单的定义你想要的分片的数量。每个分片本身是一个全功能的完全独立的“索引”，它可以部署在集群中的任何节点上。</p><p>分片对于以下两个主要原因很重要：</p><p>它允许你水平切分你的内容卷</p><p>它允许你通过分片来分布和并行化执行操作来应对日益增长的执行量</p><p><br></p><p>一个分片是如何被分配以及文档又是如何被聚集起来以应对搜索请求的，它的实现技术由Elasticsearch完全管理，并且对用户是透明的。</p><p><br></p><p>在一个网络环境下或者是云环境下，故障可能会随时发生，有一个故障恢复机制是非常有用并且是高度推荐的，以防一个分片或节点不明原因下线，或者因为一些原因去除没有了。为了达到这个目的，Elasticsearch允许你制作分片的一个或多个拷贝放入一个叫做复制分片或短暂复制品中。</p><p><br></p><p>复制对于以下两个主要原因很重要：</p><p><br></p><p>&nbsp;&nbsp;高可用。它提供了高可用来以防分片或节点宕机。为此，一个非常重要的注意点是绝对不要将一个分片的拷贝放在跟这个分片相同的机器上。</p><p><br></p><p>&nbsp;&nbsp;高并发。它允许你的分片可以提供超出自身吞吐量的搜索服务，搜索行为可以在分片所有的拷贝中并行执行。</p><p><br></p><p>总结一下，每个索引可以被切分成多个分片，一个索引可以被复制零次(就是没有复制)或多次。一旦被复制，每个索引将会有一些主分片(就是那些最原始不是被复制出来的分片)，还有一些复制分片(就是那些通过复制主分片得到的分片)。</p><p><br></p><p>主分片和复制分片的数量可以在索引被创建时指定。索引被创建后，你可以随时动态修改复制分片的数量，但是不能修改主分片的数量。</p><p><br></p><p>默认情况下，在Elasticsearch中的每个索引被分配5个主分片和一份拷贝，这意味着假设你的集群中至少有两个节点，你的索引将会有5个主分片和5个复制分片(每个主分片对应一个复制分片，5个复制分片组成一个完整拷贝)，总共每个索引有10个分片。</p><p><br></p><p>每个Elasticsearch分片是一个Lucene索引。在一个Lucene索引中有一个文档数量的最大值。截至LUCENE-5843，这个限制是2,147,483,519 (= Integer.MAX_VALUE - 128)个文档。你可以使用_cat/shards API监控分片大小。</p><p><br></p><p><br></p>